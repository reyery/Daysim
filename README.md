# DAYSIM

This repository is a fork of the [RADIANCE mirror repository maintained by NREL](https://github.com/NREL/Radiance) and includes the source code for the [DAYSIM](http://daysim.ning.com/) suite. _Programs in this repository compile on Windows (VS2013) and Mac (XCode), but **testing is not complete**._ The following DAYSIM programs are part of this repository:

Programs maintained here (in src/daysim):
* ds_el_lighting
* ds_illum
* ds_shortterm
* gen_dc
* gen_dgp_profile
* gen_directsunlight
* gen_reindl
* gen_single_office
* gencumulativesky
* radfiles2daysim
* rotate_scene
* scale_dc

Programs maintained here that require manual intervention to compile (in src/rt):
* rtrace_dc
* rtrace_dc_2305

Programs maintained on the main RADIANCE repository and included here:
* epw2wea
* evalglare
* gendaylit
* _all the original RADIANCE programs_

## How to Compile DAYSIM

### Clone the repository to your own computer

1. Open cmd (Windows) or Terminal (Mac) and navigate to the folder you would like to add the source code to using the cd command. Mine is _D:/myname_ for Windows and _Users/myname_ for Mac.
2. Clone the repository to your local machine. The command is:
`git clone https://github.com/MITSustainableDesignLab/Daysim.git`
3. Navigate into the repository folder that was just created. The command is:
`cd Daysim`
4. Check out the combined branch of the repository to make it current. The command is:
`git checkout combined`
5. Add an upstream reference to Radiance. The command is:
`git remote add upstream https://github.com/NREL/Radiance.git`

### Create the DAYSIM project

1. Open CMake. You can download CMake from https://cmake.org/.
2. Enter the location of the DAYSIM project folder in the line "Where is the source code:". In the example above, mine is _D:/myname/Daysim_ for Windows and _Users/myname/Daysim_ for Mac. 
3. Enter a **different** location in the line "Where to build the binaries:". Using a different location prevents your built project (which is specific to your operating system) from being committed to the repository. The location you select could be a folder that doesn’t exist yet. Mine is _D:/myname/Daysim64_ for Windows because I compile 64-bit programs and _Users/myname/DS_Build_ for Mac.
4. Click _Configure_ and select the generator for the project. I use Visual Studio 12 2013 Win64. For Mac, I use XCode.
	- Optional: After the project configures, you may see some errors related to Qt5, which is used to build Radiance’s rvu program. If you have Qt5 installed, you can enter its location at the entry for Qt5Widgets_DIR, which currently says Qt5Widgets_DIR-NOTFOUND. For Windows, mine is _C:\Qt\5.5\msvc2013_64\lib\cmake\Qt5Widgets_. Then click _Configure_ again.
5. Click _Generate_ to build the project for your operating system.

### Compile DAYSIM

#### Windows

1. Open the Visual Studio project file, which is located in your build folder. Mine is _D:/myname/Daysim64/daysim.sln_.
2. In the toolbar, you may choose either "Debug" or "Release" settings. Debug (the default) will take longer to compile and run, but will allow you to step through running code using the debugger. Use Release settings for creating distributable packages.
3. Choose Build > Build Solution from the menus.
    - Optional: You may see errors related to the normtiff and ra_tiff projects. To fix these, you need to build libtiff.lib.
        1. Navigate to _Start_ > _All Programs_ > _Visual Studio 2013_ > _Visual Studio Tools_ and run VS2013 x64 Native Tools Command Prompt (assuming you are creating a 64-bit build).
		2. Navigate to the libtiff directory, which downloaded when you built the DAYSIM project. Mine is _D:\myname\Daysim64\Downloads\Source\radiance_support\src\px\tiff\libtiff_.
		3. Run this command:
`nmake /f makefile.vc all`
		4. In CMake, set the following variables:
			- TIFF_HEADER: `D:/myname/Daysim64/Downloads/Source/radiance_support/src/px/tiff/libtiff`
			- TIFF_LIBRARY: `D:/myname/Daysim64/Downloads/Source/radiance_support/src/px/tiff/libtiff/libtiff.lib`
		5. In CMake, click _Generate_.
		6. In Visual Studio, choose _Build_ > _Build Solution_.
4. Check that the executables have been built to your bin folder. Mine are in _D:\myname\Daysim64\bin\Debug_ or _D:\myname\Daysim64\bin\Release_.

#### Mac

1. Open the XCode project generated by CMake, located in your build folder. Mine is _Users/myname/DS_Build/daysim.xcodeproj_.
2. In the top left corner, choose ALL_BUILD (default) to build all executables, or select certain programs from the drop-down menu. Press the play button to build the project according to specifications.
3. View any warnings or errors in the navigation panel on the left. Even if XCode indicates "Build Failed", errors that caused the failure may not have occurred in crucial programs.
4. Check that the executables have been built to your bin folder. Mine are in _Users/myname/DS_Build/bin/Debug_.

### Pull Updates from Radiance

1. Download updates from the upstream Radiance branch. The command is:
`git fetch upstream`
2. Merge the changes into your working set. The command is:
`git merge upstream/combined`

You can do the same to pull updates from this repository by replacing _upstream_ with _origin_.


## License

### DAYSIM

SOFTWARE END-USER LICENSE AGREEMENT

Copyright (c) 2012 National Research Council Canada, Ottawa, Canada

Copyright (c) 2012 Fraunhofer Institute for Solar Energy Systems, Freiburg, Germany

IMPORTANT READ CAREFULLY: 

This end user license agreement is a legal agreement between you, in your capacity as an individual and/or as an agent for your company, institution or other entity (called herein the "User") and the NATIONAL RESEARCH COUNCIL OF CANADA and the FRAUNHOFER INSTITUTE FOR SOLAR ENERGY SYSTEMS (collectively called herein "NRC/ISE"). 

The User desires to use the computer software, in source code form, developed by NRC/ISE and identified as DAYSIM (called herein the "Software", a term which includes both original and modified versions of computer programs and computer data, and also includes printed matter intended to explain or assist the use of parts of the Software). Downloading, installing, using or copying the software by the User or a third party indicates that the User agrees to be bound by the terms and conditions that follow:

1. TITLE AND GRANT

    NRC/ISE grant to the User, and the User accepts, a non-transferable, non-exclusive licence to install and use the version of the computer software program noted above, without any licence fee, only in the manner described under the heading "USAGE". All proprietary interest, right, title, and copyright in the Software which are not explicitly granted to you herein remain with NRC/ISE.
    
2. USAGE

    2.1 The User may install and use the Software.
    
    2.2 The User may copy the Software for backup or archival purposes provided that the user reproduces all copyright notices and other proprietary notices on any copies of the Software.
    
    2.3 The User may create computer programs which incorporate or modify the Software. These programs may be made available to other persons under the following conditions:
    
    (a) the new software shall include a statement giving appropriate credit to NRC/ISE for the development of DAYSIM
    
    (b) NRC/ISE will both receive one free copy of the new software that will allow NRC/ISE to verify that requirement (a) has been fully satisfied. Failure to provide NRC/ISE with a new software later than 10 working days before its original release will terminate this User Licence Agreement.
    
    2.4 Materials generated through the use of the Software and/or data collected from using the Software (e.g. publications, web pages, presentation) shall include a statement giving appropriate credit to NRC/ISE.
    
3. NO MAINTENANCE SUPPORT

    NRC/ISE shall be under no obligation whatsoever to provide maintenance or support for the Software; or to notify the User of bug fixes, patches, or upgrades to the Software (if any). If, in its sole discretion, NRC/ISE makes a Software bug fix, patch or upgrade available to the User and NRC/ISE does not separately enter into a written license agreement with the User relating to such bug fix, patch or upgrade, then it shall be deemed incorporated into the Software and subject to this Agreement.

WARRANTY DISCLAIMER

THE SOFTWARE IS SUPPLIED "AS IS". NRC/ISE DISCLAIM ANY WARRANTIES, EXPRESSED, IMPLIED, OR STATUTORY, OF ANY KIND OR NATURE WITH RESPECT TO THE SOFTWARE, INCLUDING WITHOUT LIMITATION ANY WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. NRC/ISE SHALL NOT BE LIABLE IN ANY EVENT FOR ANY DAMAGES, WHETHER DIRECT OR INDIRECT, SPECIAL OR GENERAL, CONSEQUENTIAL OR INCIDENTAL, ARISING FROM THE USE OF THE SOFTWARE.

NRC/ISE DO:

(1) NOT ASSUME ANY LEGAL LIABILITY OR RESPONSIBILITY FOR THE ACCURACY, COMPLETENESS, OR USEFULNESS OF THE SOFTWARE,

(2) NOT WARRANT THAT THE SOFTWARE WILL FUNCTION UNINTERRUPTED, THAT IT IS ERROR-FREE OR THAT ANY ERRORS WILL BE CORRECTED.

If you have any questions concerning this license, contact Dr. Christoph Reinhart, National Research Council, Montreal Road, Ottawa, Ontario, K1A 0R6, Canada.

BY DOWNLOADING, INSTALLING, OR USING THE SOFTWARE YOU ARE INDICATING YOUR ACCEPTANCE OF THE TERMS AND CONDITIONS HEREIN.

## RADIANCE 5.0

The Radiance Software License, Version 1.0

Copyright (c) 1990 - 2015 The Regents of the University of California, through Lawrence Berkeley National Laboratory.   All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
3. The end-user documentation included with the redistribution, if any, must include the following acknowledgment:

    "This product includes Radiance software (<http://radsite.lbl.gov/>) developed by the Lawrence Berkeley National Laboratory (<http://www.lbl.gov/>)."
        
    Alternately, this acknowledgment may appear in the software itself, if and wherever such third-party acknowledgments normally appear.
4. The names "Radiance," "Lawrence Berkeley National Laboratory" and "The Regents of the University of California" must not be used to endorse or promote products derived from this software without prior written permission. For written permission, please contact radiance@radsite.lbl.gov.
5. Products derived from this software may not be called "Radiance", nor may "Radiance" appear in their name, without prior written permission of Lawrence Berkeley National Laboratory.

THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.   IN NO EVENT SHALL Lawrence Berkeley National Laboratory OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software consists of voluntary contributions made by many individuals on behalf of Lawrence Berkeley National Laboratory.  For more information on Lawrence Berkeley National Laboratory, please see <<http://www.lbl.gov/>>.

### EvalGlare 1.0

Evalglare Software License, Version 1.0

Copyright (c) 1995 - 2012 Fraunhofer ISE.

All rights reserved.

Redistribution and use in source and binary forms, WITHOUT modification, are permitted provided that the following all conditions are met:

THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.   IN NO EVENT SHALL Fraunhofer ISE  OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

### GenCumulativeSky

SOFTWARE END-USER BSD LICENSE AGREEMENT

Copyright (c) 2012, Darren Robinson and Andy Stone

All rights reserved.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
